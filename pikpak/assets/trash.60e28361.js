import{d as x,o as _,e as S,f as t,r,g as B,G as L,h as v,k as d,u as s,s as a,N as M,H as w,l as N,x as h,A as b,C as z,p as f,O as l,P as H,y as A,Q as C}from"./index.a49f5493.js";import{N as P,a as $}from"./BreadcrumbItem.2d213ea1.js";import{b as U,N as V,a as I}from"./Spin.0a575336.js";import{N as q}from"./Popconfirm.60fa3977.js";import{N as G}from"./Space.97e1592c.js";import"./Checkbox.f0d22f72.js";import"./get.69c10f29.js";const O={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},R=t("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M19 18v-6a3 3 0 0 0-3-3H9"}),t("path",{d:"M13 13L9 9l4-4m-5 8L4 9l4-4"})],-1);var j=x({name:"CornerUpLeftDouble",render:function(n,i){return _(),S("svg",O,[R])}});const K={class:"list-page"},Q={class:"header"},W={class:"title n-ellipsis"},X=f("\u56DE\u6536\u7AD9"),Y={key:0,class:"loading"},Z=f("\u52A0\u8F7D\u4E2D "),J={key:0,class:"outer-wrapper static show"},ee={class:"toolbar-wrapper"},te=f(" \u8FD8\u539F\u6240\u9009 "),se=f(" \u5220\u9664\u6240\u9009 "),de=x({setup(F){const n=r(),i=r([]),D=r([{title:"\u5220\u9664\u65F6\u95F4",key:"modified_time",sorter:"default",render:e=>l(H,{time:new Date(String(e.created_time)||""),format:"MM-dd HH:MM"}),className:"modified_time",width:200},{title:"\u5927\u5C0F",key:"size",sorter:"default",render:e=>Number(e.size)>0?A(Number(e.size)):"",className:"size",width:160}]),k=r([{type:"selection"},{title:"\u540D\u79F0",key:"name",sorter:"default",render:e=>l("div",{class:"file-info"},[l("img",{src:e.thumbnail_link||e.icon_link}),l(I,{class:"title"},{default:()=>String(e.name)}),l("span",{class:"action"},"1")])},{title:"\u64CD\u4F5C",key:"action",width:90,align:"right",render:e=>l(G,{},{default:()=>[l(C,{type:"primary",onClick:()=>{y(String(e.id))}},{default:()=>"\u8FD8\u539F"}),l(q,{placement:"right",onPositiveClick:()=>{g(String(e.id))}},{trigger:()=>l(C,{type:"primary"},{default:()=>"\u5220\u9664"}),default:()=>"\u786E\u5B9A\u5220\u9664\u6587\u4EF6\u5417\uFF1F"})]})}]),c=r(!1),p=r(),m=()=>{c.value=!0,h.get("https://api-drive.mypikpak.com/drive/v1/files",{params:{parent_id:"*",thumbnail_size:"SIZE_LARGE",with_audit:!0,page_token:p.value||void 0,filters:{phase:{eq:"PHASE_TYPE_COMPLETE"},trashed:{eq:!0}}}}).then(e=>{const{data:o}=e;p.value||(n.value=[]),n.value=n.value.concat(o.files),p.value=o.next_page_token}).finally(()=>{c.value=!1})},g=e=>{h.post("https://api-drive.mypikpak.com/drive/v1/files:batchDelete",{ids:typeof e=="string"?[e]:e}).then(()=>{window.$message.success("\u5220\u9664\u6210\u529F"),m()})},y=e=>{h.post("https://api-drive.mypikpak.com/drive/v1/files:batchUntrash",{ids:typeof e=="string"?[e]:e}).then(()=>{m()})},E=e=>{e.target.offsetHeight-e.target.scrollTop<30&&p.value&&!c.value&&m()};return B(()=>{document.body.clientWidth>968&&k.value.splice(2,0,...D.value),m()}),(e,o)=>{const T=L("router-link");return _(),v("div",K,[d("div",Q,[d("div",W,[t(s(P),{separator:">"},{default:a(()=>[t(s($),null,{default:a(()=>[t(T,{to:""},{default:a(()=>[X]),_:1})]),_:1})]),_:1})])]),t(s(M),{style:{"max-height":"calc(100vh - 190px)"},onScroll:E},{default:a(()=>[t(s(U),{"checked-row-keys":i.value,"onUpdate:checked-row-keys":o[0]||(o[0]=u=>i.value=u),"row-key":u=>u.id,data:n.value,size:"small",columns:k.value,bordered:!1},null,8,["checked-row-keys","row-key","data","columns"]),c.value?(_(),v("div",Y,[t(s(V),{size:"small"}),Z])):N("",!0)]),_:1}),i.value.length?(_(),v("div",J,[d("div",ee,[d("div",{class:"toolbar-item",onClick:o[1]||(o[1]=u=>y(i.value))},[t(s(w),null,{trigger:a(()=>[t(s(b),null,{default:a(()=>[t(s(j))]),_:1})]),default:a(()=>[te]),_:1})]),d("div",{class:"toolbar-item",onClick:o[2]||(o[2]=u=>g(i.value))},[t(s(w),null,{trigger:a(()=>[t(s(b),null,{default:a(()=>[t(s(z))]),_:1})]),default:a(()=>[se]),_:1})])])])):N("",!0)])}}});export{de as default};
